# Network Parameters
NETWORK=config["parameters"]["network_file"]
OUTPATH=config["parameters"]["outpath"]

GENESET=config["parameters"]["geneset_file"]
GENESET_CSV = config["parameters"]["geneset_csv"]

TOPOLOGY = config["topology"]["analyse"]
ASSOCIATION = config["association"]["analyse"]
COMPARISON = config["within_comparison"]["analyse"]

EXTENSIONS=config['figures']['extension']
OUTFIGURES=config['figures']['outpath']




# If the matrices for the full analysis are not specified, they are generated by the rule
if len(config["parameters"]["sp_matrix"])>0:
    SP_MATRIX=config["parameters"]["sp_matrix"]
else:
    SP_MATRIX=OUTPATH+"_sp_matrix.hdf5"
if len(config["parameters"]["rwr_matrix"])>0:
    RWR_MATRIX=config["parameters"]["rwr_matrix"]
else:
    RWR_MATRIX=OUTPATH+"_rwr_matrix.hdf5"

include: "rules/paper_analysis.smk"
include: "rules/paper_visualise.smk"
include: "rules/paper_hdn.smk"
include: "rules/paper_sbm.smk"

rule all:
    input:
        expand(OUTPATH+"table_topology_{t}.csv", t=TOPOLOGY),
        expand(OUTFIGURES+"barplot_{t}.{e}", t=TOPOLOGY, e=EXTENSIONS),
        expand(OUTPATH+"table_association_{t}.csv", t=ASSOCIATION),
        expand(OUTFIGURES+"heatmap_association_{t}.{e}", t=ASSOCIATION, e=EXTENSIONS),
        expand(OUTPATH+"table_within_comparison_{t}.csv", t=COMPARISON),
        expand(OUTFIGURES+"heatmap_within_comparison_{t}.{e}", t=COMPARISON, e=EXTENSIONS),

rule single_all:
    input:
        expand(OUTPATH+"table_topology_{t}.csv", t=TOPOLOGY),
        expand(OUTFIGURES+"barplot_{t}.{e}", t=TOPOLOGY, e=EXTENSIONS),
        expand(OUTPATH+"table_association_{t}.csv", t=ASSOCIATION),
        expand(OUTFIGURES+"volcano_{t}.{e}", t=ASSOCIATION, e=EXTENSIONS),
        OUTPATH+"table_diffusion.csv"

rule multi_all:
    input:
        expand(OUTPATH+"table_topology_{t}.csv", t=TOPOLOGY),
        expand(OUTFIGURES+"barplot_{t}.{e}", t=TOPOLOGY, e=EXTENSIONS),
        expand(OUTPATH+"table_within_comparison_{t}.csv", t=COMPARISON),
        expand(OUTFIGURES+"heatmap_within_comparison_{t}.{e}", t=COMPARISON,e=EXTENSIONS),

rule hdn_all:
    input:
        OUTPATH+"final_hdn.csv"

rule sbm_all:
    input:
        OUTPATH+"final_sbm.csv"